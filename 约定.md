## 交互与动画约定

- 一切动画都要基于真实物理的模拟

## 玩家手牌拖拽（桌面端 / Pointer Events）

### 总体目标

- **摇杆手感**：拖拽像手机游戏摇杆一样，接近边界更“重”，并且在高位上拉时左右滑动不会“卡住”，轨迹自然、连续。
- **物理回弹**：松手回弹使用欠阻尼弹簧（可见但克制的过冲），符合真实物理规律。
- **视觉放大**：卡牌**不会点击立即变大**；放大只跟随阻尼强度变化，阻尼越大越大。

### 拖拽范围（当前实现）

- **左右最大拖拽**：±200px
- **向上最大拖拽**：250px（只允许向上，禁止向下）
- **边界形状**：以椭圆为约束区域（弧形边界），保证在任何高度继续左右拖拽都能沿边界自然滑动，不出现停顿感。

### 阻尼规则（当前实现）

- **阻尼启动阈值**：从出发到最大距离的 **1/3** 后开始启用阻尼（更早阶段基本不加阻尼）。
- **阻尼曲线**：使用 out 曲线增长（非线性），越接近边界阻尼越大，但尾端增速已做“轻微减弱”以避免突兀。
- **摇杆分解**：将拖拽增量分解为
  - **径向（向外）**：阻尼最大（越接近边界越推不动）
  - **切向（绕圈/左右）**：也会变重，但更轻，以保持弧形滑动的连续性
- **上拉高度对左右阻尼的影响**：
  - 上拉超过一定高度后，左右切向阻尼会明显加大，避免“能画出大圆形”的感觉（弧形只保留小范围）
  - 同时保留“上拉时左右滑动也有微量阻尼”的手感（更“带劲”）
- **背景边缘相关阻尼**：
  - 允许鼠标接近 `.tableBg` 边缘时阻尼更大
  - 为避免“刚开始拖就突然放大/变重”，边缘阻尼会随实际拉扯距离逐步参与（拉得越多，边缘影响才越大）

### 卡牌放大规则（当前实现）

- **不点击即放大**：按下不放大（scale base = 1.0）
- **放大随阻尼**：阻尼越大，scale 越大；最大阻尼时的最大放大幅度已上调（更明显）

### 松手回弹（当前实现）

- **回弹模型**：欠阻尼弹簧（JS 逐帧模拟，`requestAnimationFrame`）
- **动力学形式**：
  - \(k = \omega^2\)
  - \(c = 2\zeta\omega\)
  - 保证 \(\zeta < 1\)（可见过冲，但通过提高 \(\zeta\) 和降低速度注入来让过冲更克制）
- **速度注入与过冲**：
  - 松手速度会被 clamp，并进一步缩放以减小过冲力度
  - 当前已把过冲力度整体调小一档（更不弹、更快收敛）

### 关键可调参数（在 `src/ui.js` 顶部附近）

- **拖拽范围**：
  - `CARD_DRAG_CAP_X_PX`（左右最大）
  - `CARD_DRAG_CAP_UP_PX`（向上最大）
- **阻尼**：
  - `DAMP_START_FRAC`（阻尼从最大距离的多少比例后开始）
  - `CARD_DRAG_DAMP_P`（阻尼 out 曲线强度）
  - `EDGE_DAMP_RADIUS_PX`（靠近背景边缘的影响半径）
- **放大**：
  - `CARD_DRAG_SCALE_BASE`（基础 scale，建议保持 1.0）
  - `CARD_DRAG_SCALE_EXTRA`（最大阻尼时额外放大）
- **回弹弹簧**（在 `startSpringBack()` 内）：
  - 速度 clamp / 注入倍率
  - `omega` / `zeta` 的计算范围（决定回弹快慢与过冲克制程度）

