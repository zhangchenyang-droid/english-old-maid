# å‡ºç‰ŒåŠ¨ç”»ç»Ÿä¸€æ–¹æ¡ˆ

## æ€»è§ˆ

æ‰€æœ‰å‡ºç‰ŒåŠ¨ç”»ï¼ˆç©å®¶ + AIï¼‰ä½¿ç”¨**ç»Ÿä¸€çš„ç‰©ç†åŠ¨ç”»ç³»ç»Ÿ**ï¼š
- âœ… æŠ›ç‰©çº¿è½¨è¿¹ï¼ˆè´å¡å°”æ›²çº¿ï¼‰
- âœ… è¿‡å†²å›å¼¹ï¼ˆä¸¤æ®µå¼ç¼“åŠ¨ï¼‰
- âœ… ç²¾ç¡®ç¼©æ”¾ï¼ˆåŠ¨æ€è®¡ç®—ï¼‰
- âœ… è§’åº¦ä¸€è‡´æ€§ï¼ˆhash å‡½æ•°ï¼‰

---

## ä¸¤ç§å‡ºç‰Œåœºæ™¯

### 1. ç©å®¶å‡ºç‰Œï¼ˆ`flyToDiscard`ï¼‰

**è§¦å‘**ï¼šç©å®¶é€‰æ‹©ä¸¤å¼ é…å¯¹å¡ï¼Œç‚¹å‡»"åŒ¹é…å‡ºç‰Œ"

**åŠ¨ç”»ç‰¹å¾**ï¼š
- èµ·ç‚¹ï¼šç©å®¶æ‰‹ç‰Œä½ç½®ï¼ˆåº•éƒ¨ï¼‰
- ç»ˆç‚¹ï¼šå¼ƒç‰Œå †ï¼ˆå·¦å † 28% / å³å † 72%ï¼‰
- è½¨è¿¹ï¼šæŠ›ç‰©çº¿ï¼ˆ`arcHeight = min(80, dist * 0.3)`ï¼‰
- è¿‡å†²ï¼š4%
- æ—¶é•¿ï¼š520ms
- æ—‹è½¬ï¼šZè½´æ—‹è½¬åˆ°ç›®æ ‡è§’åº¦
- ç¿»è½¬ï¼šæ— ï¼ˆå·²æ˜¯æ­£é¢ï¼‰

**ä»£ç ä½ç½®**ï¼š`src/ui.js:273-397`

**å®ç°è¦ç‚¹**ï¼š
```javascript
// ç›´æ¥æ“ä½œåŸå§‹å¡ç‰Œå…ƒç´ ï¼Œä¸å…‹éš†
fromEl.classList.add("flyingCard");
fromEl.style.position = "fixed";

// 30å¸§å…³é”®å¸§åŠ¨ç”»
for (let i = 0; i <= 30; i++) {
  // è´å¡å°”æ›²çº¿è½¨è¿¹
  const baseX = (1-arcT)Â² * startX + 2(1-arcT)arcT * controlX + arcTÂ² * targetX
  const baseY = (1-arcT)Â² * startY + 2(1-arcT)arcT * controlY + arcTÂ² * targetY

  // è¿‡å†²å›å¼¹
  overshoot = t <= 0.68 ? 1.04 : (1.04 â†’ 1.0)

  keyframes.push({
    left: `${x}px`,
    top: `${y}px`,
    transform: `translate(-50%, -50%) scale(${scale}) rotate(${rotation}deg)`,
    opacity: opacity
  })
}
```

---

### 2. AI å‡ºç‰Œï¼ˆ`animateAiDiscardPair`ï¼‰

**è§¦å‘**ï¼šAI å›åˆä¸­å‘ç°é…å¯¹ï¼Œè‡ªåŠ¨å‡ºç‰Œ

**åŠ¨ç”»ç‰¹å¾**ï¼š
- èµ·ç‚¹ï¼šAI æ‰‹ç‰Œä½ç½®ï¼ˆä¸Š/å·¦/å³ï¼‰
- ç»ˆç‚¹ï¼šå¼ƒç‰Œå †ï¼ˆå·¦å † 28% / å³å † 72%ï¼‰
- è½¨è¿¹ï¼šæŠ›ç‰©çº¿ï¼ˆ`arcHeight = min(80, dist * 0.3)`ï¼‰
- è¿‡å†²ï¼š4%
- æ—¶é•¿ï¼š520ms
- æ—‹è½¬ï¼šZè½´æ—‹è½¬åˆ°ç›®æ ‡è§’åº¦
- **ç¿»è½¬ï¼šYè½´ 0Â° â†’ 180Â°ï¼ˆèƒŒé¢ç¿»åˆ°æ­£é¢ï¼‰**

**ä»£ç ä½ç½®**ï¼š`src/ui.js:920-1187`

**æ ¸å¿ƒåˆ›æ–°ï¼šåŒå±‚åµŒå¥— + 90Â° åŠ¨æ€æ›¿æ¢**

#### ç»“æ„è®¾è®¡

```javascript
// å¤–å±‚å®¹å™¨ï¼šè´Ÿè´£ä½ç½®ç§»åŠ¨ã€ç¼©æ”¾ã€Zè½´æ—‹è½¬
outerContainer {
  position: fixed
  åŠ¨ç”»: left, top, transform (translate, scale, rotate)

  // å†…å±‚å®¹å™¨ï¼šä¸“é—¨è´Ÿè´£ Yè½´ç¿»è½¬
  flipContainer {
    transformStyle: "preserve-3d"
    åŠ¨ç”»: transform (rotateY: 0Â° â†’ 180Â°)

    // èƒŒé¢ï¼ˆ0Â°-90Â° å¯è§ï¼‰
    backFace {
      className: "miniBack"
      transform: rotateY(0deg)
      backfaceVisibility: hidden
      å†…å®¹: å¡èƒŒå›¾ç‰‡
    }

    // æ­£é¢ï¼ˆ90Â°-180Â° å¯è§ï¼‰
    frontFace {
      transform: rotateY(180deg)
      backfaceVisibility: hidden
      åˆå§‹: åŠé€æ˜èƒŒæ™¯ï¼ˆç©ºå†…å®¹ï¼‰
      90Â° æ—¶å¡«å……: className + innerHTML
    }
  }
}
```

#### ç¿»è½¬æ—¶é—´çº¿

```
T=0ms          T=260ms         T=520ms
  â†“              â†“               â†“
ğŸŒ² (0Â°)         | (90Â°)         ğŸ´ (180Â°)
èƒŒé¢å¯è§        ä¾§é¢            æ­£é¢å¯è§
              â†‘ å…³é”®æ—¶åˆ»ï¼
        æ£€æµ‹åˆ° currentFlipRotation >= 90Â°
        â†“
        frontFace.className = "faceCard imgCard"
        frontFace.innerHTML = "<img src='...' />"
        â†“
        ç»§ç»­ç¿»è½¬ 90Â° â†’ 180Â°
        æ­£é¢é€æ¸æ˜¾ç°
```

#### 90Â° æ£€æµ‹é€»è¾‘

```javascript
// ä½¿ç”¨ requestAnimationFrame å®æ—¶æ£€æµ‹ç¿»è½¬è¿›åº¦
let flipped = false;
const checkFlip = () => {
  if (flipped || flipAnim.playState === 'finished') return;

  const currentTime = flipAnim.currentTime || 0;
  const progress = currentTime / 520;

  // è®¡ç®—å½“å‰ç¿»è½¬è§’åº¦ï¼ˆä½¿ç”¨å’Œå…³é”®å¸§ç›¸åŒçš„ç¼“åŠ¨å‡½æ•°ï¼‰
  let easeT;
  if (progress <= 0.68) {
    const t1 = progress / 0.68;
    easeT = 1 - Math.pow(1 - t1, 2.5);
  } else {
    easeT = 1.0;
  }
  const currentFlipRotation = Math.min(easeT, 1.0) * 180;

  // åˆ°è¾¾ 90Â° æ—¶å¡«å……æ­£é¢å†…å®¹
  if (currentFlipRotation >= 90 && !flipped) {
    flipped = true;

    frontFace.className = `faceCard ${card.type === "img" ? "imgCard" : ""}`;
    frontFace.style.backfaceVisibility = "hidden";
    frontFace.style.transform = "rotateY(180deg)";
    frontFace.innerHTML = `<img src="${card.imgSrc}" />`;
  } else {
    requestAnimationFrame(checkFlip);
  }
};
requestAnimationFrame(checkFlip);
```

#### ä¸ºä»€ä¹ˆåˆ†ä¸¤å±‚ï¼Ÿ

**é—®é¢˜**ï¼šå¦‚æœåœ¨ä¸€ä¸ªå…ƒç´ ä¸ŠåŒæ—¶åº”ç”¨ `translate(-50%, -50%)` å’Œ `rotateY()`ï¼Œtransform ä¼šäº’ç›¸å¹²æ‰°ã€‚

**è§£å†³**ï¼š
- **å¤–å±‚**ï¼šè´Ÿè´£ 2D å˜æ¢ï¼ˆ`translate`, `scale`, `rotate`ï¼‰
- **å†…å±‚**ï¼šä¸“é—¨è´Ÿè´£ 3D ç¿»è½¬ï¼ˆ`rotateY`ï¼‰
- ä¸¤å±‚åŠ¨ç”»åŒæ­¥æ’­æ”¾ï¼Œäº’ä¸å¹²æ‰°

---

## ç©å®¶ vs AI å‡ºç‰Œå¯¹æ¯”

| ç‰¹æ€§ | ç©å®¶å‡ºç‰Œ | AI å‡ºç‰Œ |
|------|---------|---------|
| **ç»“æ„** | å•å±‚ï¼ˆåŸå§‹å…ƒç´ ï¼‰ | åŒå±‚åµŒå¥—ï¼ˆouter + flipï¼‰ |
| **è½¨è¿¹** | æŠ›ç‰©çº¿ | æŠ›ç‰©çº¿ |
| **å¼§é«˜** | `min(80, dist*0.3)` | `min(80, dist*0.3)` |
| **è¿‡å†²** | 4% | 4% |
| **æ—¶é•¿** | 520ms | 520ms |
| **å…³é”®å¸§** | 30å¸§ | 30å¸§ï¼ˆä½ç½®ï¼‰ + 30å¸§ï¼ˆç¿»è½¬ï¼‰ |
| **ç¿»è½¬** | âŒ æ— ï¼ˆå·²æ˜¯æ­£é¢ï¼‰ | âœ… Yè½´ 0Â°â†’180Â° |
| **æ›¿æ¢** | âŒ ä¸éœ€è¦ | âœ… 90Â° æ—¶åŠ¨æ€å¡«å…… |
| **ç¼©æ”¾** | åŠ¨æ€è®¡ç®— | åŠ¨æ€è®¡ç®— |
| **è§’åº¦** | Hash ä¸€è‡´ | Hash ä¸€è‡´ |

**è®¾è®¡ç†å¿µ**ï¼š
- ç©å®¶å¡ç‰Œå·²ç»æ˜¯æ­£é¢ â†’ ç›´æ¥é£è¡Œ
- AI å¡ç‰Œæ˜¯èƒŒé¢ â†’ éœ€è¦ç¿»è½¬å±•ç¤º
- ç»Ÿä¸€çš„ç‰©ç†å‚æ•° â†’ è§†è§‰ä¸€è‡´

---

## æ ¸å¿ƒæ”¹è¿›ï¼šè§’åº¦ä¸€è‡´æ€§

### é—®é¢˜
ä¹‹å‰é£è¡Œå¡ç‰Œè½åœ°æ—¶çš„è§’åº¦æ˜¯**éšæœºç”Ÿæˆ**çš„ï¼š
```javascript
const targetRotation = (Math.random() - 0.5) * 8; // âŒ æ¯æ¬¡éšæœº
```

ç»“æœï¼š
- é£è¡Œå¡ç‰Œè½åœ°è§’åº¦ï¼šéšæœº -4Â° ~ +4Â°
- å¼ƒç‰Œå †æ˜¾ç¤ºè§’åº¦ï¼šåŸºäº `hash(cardId + z)` è®¡ç®—
- **ä¸ä¸€è‡´**ï¼šå¡ç‰Œè½åœ°åä¼š"è·³å˜"åˆ°æ–°è§’åº¦

### è§£å†³æ–¹æ¡ˆ
ä½¿ç”¨**ä¸å¼ƒç‰Œå †å®Œå…¨ç›¸åŒ**çš„è§’åº¦è®¡ç®—ï¼š

```javascript
// 1. è®¡ç®—è¯¥å¡ç‰Œåœ¨å¼ƒç‰Œå †ä¸­çš„ z-index
const currentDiscardLength = game.discardPile.length;
const isLeft = cardId.includes("_A");
const targetZ = isLeft
  ? (10 + Math.floor(currentDiscardLength / 2))   // å·¦å †
  : (100 + Math.floor(currentDiscardLength / 2)); // å³å †

// 2. ä½¿ç”¨ç›¸åŒçš„ hash å‡½æ•°è®¡ç®—è§’åº¦
function hash01(str) {
  let h = 2166136261;
  for (let i = 0; i < str.length; i++) {
    h ^= str.charCodeAt(i);
    h = Math.imul(h, 16777619);
  }
  return ((h >>> 0) % 10000) / 10000;
}
const targetRotation = (hash01(`${cardId}|${targetZ}`) - 0.5) * 8;

// 3. é£è¡ŒåŠ¨ç”»ä½¿ç”¨è¿™ä¸ªè§’åº¦
{ transform: `... rotate(${targetRotation}deg)` }
```

### æ•ˆæœ
- âœ… é£è¡Œå¡ç‰Œè½åœ°è§’åº¦ = å¼ƒç‰Œå †æ˜¾ç¤ºè§’åº¦
- âœ… æ— "è·³å˜"ï¼Œå®Œç¾è¡”æ¥
- âœ… æ¯å¼ å¡çš„è§’åº¦å›ºå®šä¸”å¯é‡ç°

---

## æ ¸å¿ƒæ”¹è¿›ï¼šç¼©æ”¾ä¸€è‡´æ€§

### é—®é¢˜
ä¹‹å‰é£è¡Œå¡ç‰Œçš„ç›®æ ‡å¤§å°æ˜¯**ç¡¬ç¼–ç **çš„ï¼š
```javascript
{ transform: `... scale(0.65)` } // âŒ å›ºå®šç¼©æ”¾
```

ç»“æœï¼š
- é£è¡Œå¡ç‰Œè½åœ°å¤§å°ï¼š92px * 0.65 = 60px
- å¼ƒç‰Œå †æ˜¾ç¤ºå¤§å°ï¼š92px * `--scale-discard-pile`ï¼ˆå¯è°ƒï¼‰
- **ä¸ä¸€è‡´**ï¼šå¦‚æœç”¨æˆ·è°ƒæ•´äº†å¼ƒç‰Œå †å¤§å°ï¼Œé£è¡ŒåŠ¨ç”»ä¸ä¼šè·Ÿéš

### è§£å†³æ–¹æ¡ˆ
ä½¿ç”¨**åŠ¨æ€è®¡ç®—**çš„ç¼©æ”¾æ¯”ä¾‹ï¼š

```javascript
// 1. è¯»å– CSS å˜é‡ï¼ˆç”¨æˆ·å¯è°ƒï¼‰
const discardScale = parseFloat(
  getComputedStyle(document.documentElement)
    .getPropertyValue('--scale-discard-pile') || "0.82"
);

// 2. è®¡ç®—ç›®æ ‡å¤§å°
const targetWidth = 92 * discardScale; // å¼ƒç‰Œå †å®é™…å®½åº¦

// 3. è®¡ç®—ç¼©æ”¾æ¯”ä¾‹
const scaleTarget = targetWidth / 86; // ä»86pxç¼©æ”¾åˆ°ç›®æ ‡

// 4. é£è¡ŒåŠ¨ç”»ä½¿ç”¨è¿™ä¸ªç¼©æ”¾
const currentScale = 1 + (scaleTarget - 1) * easeT;
```

### æ•ˆæœ
- âœ… é£è¡Œå¡ç‰Œè½åœ°å¤§å° = å¼ƒç‰Œå †æ˜¾ç¤ºå¤§å°
- âœ… è‡ªåŠ¨é€‚é…ç”¨æˆ·è°ƒæ•´çš„å¼ƒç‰Œå †å¤§å°
- âœ… æ— ç¼©æ”¾"è·³å˜"

---

## ç‰©ç†åŠ¨ç”»å…¬å¼

### è´å¡å°”æ›²çº¿è½¨è¿¹ï¼ˆæŠ›ç‰©çº¿ï¼‰

```javascript
// èµ·ç‚¹ã€æ§åˆ¶ç‚¹ã€ç»ˆç‚¹
start = (startX, startY)
control = (controlX, controlY)  // åå‘ä¸­å¿ƒ + æŠ¬é«˜
end = (targetX, targetY)

// è´å¡å°”äºŒæ¬¡æ›²çº¿å…¬å¼
x(t) = (1-t)Â² * startX + 2(1-t)t * controlX + tÂ² * targetX
y(t) = (1-t)Â² * startY + 2(1-t)t * controlY + tÂ² * targetY

// æ§åˆ¶ç‚¹è®¡ç®—
midX = (startX + targetX) / 2
midY = (startY + targetY) / 2
toCenterX = tableBgCenterX - midX
toCenterY = tableBgCenterY - midY

arcHeight = min(80, dist * 0.3)
controlX = midX + toCenterX * 0.2  // 20% åå‘ä¸­å¿ƒ
controlY = midY + toCenterY * 0.2 - arcHeight  // å‘ä¸ŠæŠ¬é«˜
```

### è¿‡å†²å›å¼¹

```javascript
// Phase 1 (0% â†’ 68%): æ¥è¿‘ + è¿‡å†²
if (t <= 0.68) {
  t1 = t / 0.68
  easeT = 1 - (1 - t1)^2.5  // ease-out
  overshoot = 1.04  // è¿‡å†² 4%
}

// Phase 2 (68% â†’ 100%): å›å¼¹ç¨³å®š
else {
  t2 = (t - 0.68) / 0.32
  easeT2 = cubic-bezier ease-in-out
  easeT = 1.04 - 0.04 * easeT2  // ä» 1.04 å›åˆ° 1.0
  overshoot = easeT
}

// åº”ç”¨è¿‡å†²
overshootAmount = (overshoot - 1.0) * overshootDist
finalX = baseX + normX * overshootAmount
finalY = baseY + normY * overshootAmount
```

---

## AI å‡ºç‰Œç¿»è½¬åŠ¨ç”»è¯¦è§£

### åŒé¢å¡ç»“æ„

```javascript
// èƒŒé¢å…ƒç´ 
backFace {
  className: "miniBack"
  transform: rotateY(0deg)
  backfaceVisibility: hidden
  å†…å®¹: å¡èƒŒå›¾ç‰‡ï¼ˆbackground-imageï¼‰
  å¯è§æ—¶æœº: 0Â° - 90Â°
}

// æ­£é¢å…ƒç´ 
frontFace {
  transform: rotateY(180deg)  // åˆå§‹åå‘æ”¾ç½®
  backfaceVisibility: hidden
  åˆå§‹å†…å®¹: åŠé€æ˜èƒŒæ™¯ï¼ˆrgba(255,255,255,0.1)ï¼‰
  90Â° æ—¶å¡«å……: className="faceCard imgCard" + innerHTML
  å¯è§æ—¶æœº: 90Â° - 180Â°
}
```

### Yè½´ç¿»è½¬åŸç†

**ä¸ºä»€ä¹ˆ frontFace è¦è®¾ç½® `rotateY(180deg)`ï¼Ÿ**

å› ä¸ºå®¹å™¨ä¼šä» 0Â° ç¿»è½¬åˆ° 180Â°ï¼š

```
å®¹å™¨è§’åº¦      backFace æ˜¾ç¤º        frontFace æ˜¾ç¤º
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
0Â°           âœ… (0Â° - 0Â° = 0Â°)    âŒ (0Â° - 180Â° = -180Â°ï¼ŒèƒŒé¢)
45Â°          âœ… (45Â° - 0Â° = 45Â°)  âŒ (45Â° - 180Â° = -135Â°ï¼ŒèƒŒé¢)
90Â°          ä¾§é¢                 ä¾§é¢
135Â°         âŒ èƒŒé¢              âœ… (135Â° - 180Â° = -45Â°ï¼Œæ­£é¢)
180Â°         âŒ èƒŒé¢              âœ… (180Â° - 180Â° = 0Â°ï¼Œå®Œå…¨æ­£é¢)
```

**å…³é”®**ï¼š
- `backFace` ç›¸å¯¹å®¹å™¨æ˜¯ 0Â°ï¼Œéšå®¹å™¨ç¿»è½¬ä¼šé€æ¸å˜æˆèƒŒé¢
- `frontFace` ç›¸å¯¹å®¹å™¨æ˜¯ 180Â°ï¼ˆåå‘ï¼‰ï¼Œéšå®¹å™¨ç¿»è½¬ä¼šé€æ¸å˜æˆæ­£é¢
- `backfaceVisibility: hidden` è‡ªåŠ¨éšè—èƒŒé¢

### 90Â° åŠ¨æ€æ›¿æ¢

**ä¸ºä»€ä¹ˆåœ¨ 90Â° æ›¿æ¢ï¼Ÿ**

1. **æ€§èƒ½ä¼˜åŒ–**ï¼šæ­£é¢å†…å®¹ï¼ˆå›¾ç‰‡ï¼‰åœ¨ 90Â° å‰ä¸åŠ è½½
2. **è§†è§‰è‡ªç„¶**ï¼š90Â° æ—¶æ˜¯ä¾§é¢ï¼Œç”¨æˆ·çœ‹ä¸åˆ°æ›¿æ¢è¿‡ç¨‹
3. **å†…å®¹å®Œæ•´**ï¼šä» 90Â° åˆ° 180Â° æœ‰è¶³å¤Ÿæ—¶é—´è®©æ­£é¢æ˜¾ç°

**æ£€æµ‹é€»è¾‘**ï¼š

```javascript
// å®æ—¶ç›‘æµ‹ç¿»è½¬è¿›åº¦
const checkFlip = () => {
  const progress = flipAnim.currentTime / 520;

  // ä½¿ç”¨å’Œå…³é”®å¸§ç›¸åŒçš„ç¼“åŠ¨å‡½æ•°è®¡ç®—å½“å‰è§’åº¦
  let easeT;
  if (progress <= 0.68) {
    easeT = 1 - Math.pow(1 - progress / 0.68, 2.5);
  } else {
    easeT = 1.0;
  }
  const currentFlipRotation = easeT * 180;

  // åˆ°è¾¾ 90Â° æ—¶å¡«å……
  if (currentFlipRotation >= 90 && !flipped) {
    flipped = true;
    frontFace.className = "faceCard imgCard";
    frontFace.style.transform = "rotateY(180deg)"; // ä¿æŒ
    frontFace.innerHTML = "<img src='...' />";
  } else {
    requestAnimationFrame(checkFlip);
  }
};
```

### åŒåŠ¨ç”»åŒæ­¥

```javascript
// å¤–å±‚åŠ¨ç”»ï¼šä½ç½®ã€ç¼©æ”¾ã€Zè½´æ—‹è½¬
const outerAnim = outerContainer.animate(outerKeyframes, {
  duration: 520,
  easing: "linear"
});

// å†…å±‚åŠ¨ç”»ï¼šYè½´ç¿»è½¬
const flipAnim = flipContainer.animate(flipKeyframes, {
  duration: 520,
  easing: "linear"
});

// ä¸¤ä¸ªåŠ¨ç”»åŒæ—¶æ’­æ”¾ï¼Œå®Œç¾åŒæ­¥
```

---

## è§†è§‰æ—¶é—´çº¿å¯¹æ¯”

### ç©å®¶å‡ºç‰Œ
```
T=0ms          T=260ms         T=520ms
  â†“              â†“               â†“
ğŸ´             ğŸ´              ğŸ´
 â†˜ï¸             â†˜ï¸              â†“
  (æŠ›ç‰©çº¿)      (è¿‡å†²)          (è½åœ°)
```

### AI å‡ºç‰Œ
```
T=0ms          T=260ms         T=520ms
  â†“              â†“               â†“
ğŸŒ² (0Â°)         | (90Â°)         ğŸ´ (180Â°)
 â†—ï¸              â†˜ï¸              â†“
  (æŠ›ç‰©çº¿)      (å¡«å……æ­£é¢)      (è½åœ°)
  (ç¿»è½¬)        (ç»§ç»­ç¿»è½¬)
```

---

## ä»£ç ä½ç½®

### ç©å®¶å‡ºç‰Œ
- **æ–‡ä»¶**ï¼š`src/ui.js`
- **å‡½æ•°**ï¼š`flyToDiscard(fromEl)`
- **è¡Œæ•°**ï¼š273-397

### AI å‡ºç‰Œ
- **æ–‡ä»¶**ï¼š`src/ui.js`
- **å‡½æ•°**ï¼š`animateAiDiscardPair(playerIdx, card1, card2, fromRectOverride, onComplete)`
- **è¡Œæ•°**ï¼š920-1187

---

## æ€§èƒ½åˆ†æ

### ç©å®¶å‡ºç‰Œ
- å…³é”®å¸§ï¼š30 å¸§ï¼ˆä½ç½®åŠ¨ç”»ï¼‰
- å…ƒç´ ï¼š1 ä¸ªï¼ˆåŸå§‹å¡ç‰Œï¼‰
- CPUï¼š~1ms/å¼ 
- GPUï¼šâœ… transform-only

### AI å‡ºç‰Œ
- å…³é”®å¸§ï¼š30 å¸§ï¼ˆä½ç½®ï¼‰ + 30 å¸§ï¼ˆç¿»è½¬ï¼‰
- å…ƒç´ ï¼š3 ä¸ªï¼ˆouter + back + frontï¼‰
- CPUï¼š~2ms/å¼ 
- GPUï¼šâœ… transform-only + preserve-3d

### æ€»ä½“å½±å“
- æ¯æ¬¡ AI å‡ºç‰Œ 2 å¼ ï¼š~4ms
- åœ¨ 60fpsï¼ˆ16.67msï¼‰å†…ï¼šå ç”¨ <25%
- **ç»“è®º**ï¼šæ€§èƒ½ä¼˜ç§€ï¼Œæµç•…è¿è¡Œ

---

## è§†è§‰ä¸€è‡´æ€§éªŒè¯

### æµ‹è¯•æ–¹æ³•

1. å¼€å§‹æ¸¸æˆ
2. ç©å®¶å‡ºä¸€å¯¹é…å¯¹å¡
3. AI å‡ºä¸€å¯¹é…å¯¹å¡
4. è§‚å¯Ÿï¼š
   - âœ… å¡ç‰Œè½åœ°è§’åº¦ä¸€è‡´ï¼ˆæ— è·³å˜ï¼‰
   - âœ… å¡ç‰Œè½åœ°å¤§å°ä¸€è‡´ï¼ˆæ— è·³å˜ï¼‰
   - âœ… AI å¡ç‰Œç¿»è½¬æµç•…ï¼ˆèƒŒé¢ â†’ æ­£é¢ï¼‰
   - âœ… æ§åˆ¶å°æ˜¾ç¤º `[AIå‡ºç‰Œç¿»è½¬] Card0 åˆ°è¾¾90Â°ï¼Œå¡«å……æ­£é¢å†…å®¹`

5. æ‰“å¼€"è°ƒå¸ƒå±€"é¢æ¿
6. è°ƒæ•´"å¼ƒç‰Œå †å¤§å°"æ»‘å—
7. è§‚å¯Ÿé£è¡Œå¡ç‰Œæ˜¯å¦è‡ªåŠ¨é€‚é…æ–°å¤§å°

### é¢„æœŸç»“æœ

- âœ… é£è¡Œå¡ç‰Œè½åœ°æ—¶æ— è§’åº¦è·³å˜
- âœ… é£è¡Œå¡ç‰Œè½åœ°æ—¶æ— å¤§å°è·³å˜
- âœ… AI ç¿»è½¬åŠ¨ç”»åœ¨ 90Â° å‡†ç¡®æ›¿æ¢å†…å®¹
- âœ… è‡ªåŠ¨é€‚é…ç”¨æˆ·è°ƒæ•´çš„å¼ƒç‰Œå †å¤§å°
- âœ… æ‰€æœ‰å‡ºç‰ŒåŠ¨ç”»è§†è§‰è¿è´¯

---

## ç›¸å…³æ–‡ä»¶

- `src/ui.js` - æ‰€æœ‰åŠ¨ç”»å®ç°
- `styles.css` - å¡ç‰Œæ ·å¼å’Œ CSS å˜é‡
- `AIé…å¯¹å‡ºç‰ŒåŠ¨ç”»è¯´æ˜.md` - AI åŠ¨ç”»è¯¦è§£
- `çº¦å®š.md` - åæ ‡ç³»ç»Ÿå’Œç‰©ç†çº¦å®š

---

**æ›´æ–°æ—¶é—´**ï¼š2026-01-12
**ç‰ˆæœ¬**ï¼šv5.0 - Unified Physics + AI Flip Animation
**æ ¸å¿ƒç‰¹æ€§**ï¼šç©å®¶ç›´é£ + AI ç¿»è½¬ï¼Œç»Ÿä¸€ç‰©ç†å‚æ•°ï¼Œ90Â° åŠ¨æ€æ›¿æ¢
